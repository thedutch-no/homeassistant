#####
# Weater forecast new style
#
# This template pulls the weather forecast on a hourly basis
#
# https://www.home-assistant.io/integrations/template#trigger-based-handling-of-service-response-data
#####

trigger:
  - platform: time_pattern
    hours: /1
action:
  - service: weather.get_forecasts
    target:
      entity_id: weather.openweathermap
    data:
      type: hourly
    response_variable: my_forecast
sensor:
  - name: Weather Forecast Hourly
    unique_id: weather_forecast_hourly
    state: "{{ now().isoformat() }}"
    attributes:
      forecast: "{{ my_forecast['weather.openweathermap'].forecast }}"